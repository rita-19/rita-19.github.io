<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Study Programï½œç‹è€…ç‰ˆ</title>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* ================= å…¨åŸŸæ¨£å¼ ================= */
body{
  margin:0;
  font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
  font-size: 18px;              /* â­ æ•´é«”å­—è®Šå¤§ */
  line-height: 1.6;             /* â­ è€å¸«çœ‹å¾—å¾ˆèˆ’æœ */
  background: linear-gradient(#ffe6f7,#d6e8ff);
  text-align:center;
  transition:.3s;
}

.btn{
  padding:10px 16px;
  border:none;
  border-radius:14px;
  background:#ffb8d1;
  cursor:pointer;
  margin:5px;
}
.card{
  background:#fff;
  border-radius:20px;
  padding:20px;
  margin:15px;
  display:inline-block;
  width:280px;
}
.section{display:none}

/* å°é›æ¼‚æµ® */
@keyframes float{
  0%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
  100%{transform:translateY(0)}
}
.chick-container{
  width:200px;
  margin:auto;
  animation:float 3s infinite;
}
/* ================= æ·±è‰²æ¨¡å¼ ================= */
body.dark{
  background: linear-gradient(#1e1e1e,#2c2c2c);
  color:#f5f5f5;
}

body.dark .card{
  background:#3a3a3a;
}

body.dark .btn{
  background:#555;
  color:#fff;
}

body.dark input{
  background:#555;
  color:#fff;
  border:none;
}
</style>
</head>

<body>

<h1>ğŸ¥ Study Program</h1>

<!-- å°è¦½ -->
<div>
  <button class="btn" onclick="UI.show('home')">é¦–é </button>
  <button class="btn" onclick="UI.show('pomodoro')">ç•ªèŒ„é˜</button>
  <button class="btn" onclick="UI.show('quiz')">å°æ¸¬é©—</button>
  <button class="btn" onclick="UI.show('chart')">æ•¸æ“š</button>
  <button class="btn" onclick="UI.show('leaderboard')">æ’è¡Œæ¦œ</button>
  <button class="btn" onclick="UI.toggleDark()">ğŸŒ™ æ·±è‰²æ¨¡å¼</button>
</div>

<!-- ================= é¦–é  ================= -->
<section id="home" class="section" style="display:block">
  <div class="chick-container">ğŸ¥</div>

  <div class="card">
    <h3>ç­‰ç´š</h3>
    <p id="levelText">Lv.1</p>
  </div>

  <div class="card">
    <h3>ä»Šæ—¥è®€æ›¸</h3>
    <p id="todayTime">0 å°æ™‚</p>
  </div>

  <div class="card">
    <h3>å°é›æ€§æ ¼</h3>
    <p id="chickPersonalityText">å°šæœªæ¸¬é©—</p>
  </div>
</section>

<!-- ================= ç•ªèŒ„é˜ ================= -->
<section id="pomodoro" class="section">
  <h2>ğŸ… ç•ªèŒ„é˜</h2>
  <div id="timer">25:00</div>
  <button class="btn" onclick="Pomodoro.start()">é–‹å§‹</button>
</section>

<!-- ================= å°æ¸¬é©— ================= -->
<section id="quiz" class="section">
  <div class="card">
    <p id="quizQ">é¡Œç›®</p>
    <div id="quizOpt"></div>
  </div>
</section>

<!-- ================= åœ–è¡¨ ================= -->
<section id="chart" class="section">
  <canvas id="studyChart" width="300"></canvas>
</section>

<!-- ================= æ’è¡Œæ¦œ ================= -->
<section id="leaderboard" class="section">
  <div class="card">
    <h3>ğŸ‘¤ ç©å®¶ç™»å…¥</h3>
    <input id="playerName" placeholder="è¼¸å…¥åç¨±">
    <button class="btn" onclick="Player.login()">ç™»å…¥</button>

    <p style="margin-top:10px;">
      ğŸ”‘ æˆ‘çš„åˆ†äº«ç¢¼ï¼š
      <strong id="shareCodeText">å°šæœªç™»å…¥</strong>
    </p>

    <hr>

    <h3>ğŸ” ç”¨åˆ†äº«ç¢¼æŸ¥è©¢</h3>
    <input id="searchCode" placeholder="è¼¸å…¥åˆ†äº«ç¢¼">
    <button class="btn" onclick="Player.searchByCode()">æŸ¥è©¢</button>

    <p id="searchResult"></p>

    <hr>

    <h3>ğŸ† æ’è¡Œæ¦œ</h3>
    <ul id="rank"></ul>
  </div>
</section>

<script>
/* ================= ç‹€æ…‹ç®¡ç†ï¼ˆæ ¸å¿ƒï¼‰ ================= */
const State = {
  level:1,
  exp:0,
  study:[0,0,0,0,0,0,0],
  chickPersonality:"",
  currentPlayer:null,
  players:{},
  dark:false
};

/* ================= UI ================= */
const UI = {
  show(id){
    document.querySelectorAll(".section").forEach(s=>s.style.display="none");
    document.getElementById(id).style.display="block";
  },
  toggleDark(){
  State.dark = !State.dark;
  document.body.classList.toggle("dark", State.dark);
}
};

/* ================= ç©å®¶ ================= */
const Player = {
  login(){
    const name = document.getElementById("playerName").value.trim();
    if(!name) return;

    // åˆå§‹åŒ–ç©å®¶
    if(!State.players[name]){
      State.players[name] = {
        level: 1,
        study: [0,0,0,0,0,0,0],
        chickPersonality: "",
        shareCode: Math.random().toString(36).slice(2,8)
      };
    }

    State.currentPlayer = name;

    // å°‡ç©å®¶è³‡æ–™åŒæ­¥åˆ° State
    Object.assign(State, State.players[name]);

    UI.update();
    Player.updateShareCode();
    Player.updateLeaderboard();
  },

  updateShareCode(){
    const el = document.getElementById("shareCodeText");
    if(!State.currentPlayer){
      el.textContent = "å°šæœªç™»å…¥";
    }else{
      el.textContent = State.players[State.currentPlayer].shareCode;
    }
  },

  searchByCode(){
    const code = document.getElementById("searchCode").value.trim();
    const result = document.getElementById("searchResult");
    result.textContent = "";

    if(!code) return;

    for(const name in State.players){
      if(State.players[name].shareCode === code){
        result.textContent = `æ‰¾åˆ°ç©å®¶ï¼š${name}ï¼ˆLv.${State.players[name].level}ï¼‰`;
        return;
      }
    }

    result.textContent = "âŒ æ‰¾ä¸åˆ°æ­¤åˆ†äº«ç¢¼";
  },

  updateLeaderboard(){
    const ul = document.getElementById("rank");
    ul.innerHTML = "";

    const list = Object.entries(State.players);

    list.forEach(([name,data])=>{
      const li = document.createElement("li");
      li.textContent = `${name} ï½œ Lv.${data.level}`;
      if(name === State.currentPlayer){
        li.style.fontWeight = "bold";
      }
      ul.appendChild(li);
    });
  }
};


/* ================= UI æ›´æ–° ================= */
UI.update = ()=>{
  document.getElementById("levelText").textContent = "Lv."+State.level;
  document.getElementById("todayTime").textContent = State.study[new Date().getDay()||6]+" å°æ™‚";
  document.getElementById("chickPersonalityText").textContent =
    State.chickPersonality || "å°šæœªæ¸¬é©—";
  Player.updateShareCode();
};

/* ================= ç•ªèŒ„é˜ ================= */
const Pomodoro = {
  time:1500,
  start(){
    setInterval(()=>{
      Pomodoro.time--;
      document.getElementById("timer").textContent =
        Math.floor(Pomodoro.time/60)+":"+String(Pomodoro.time%60).padStart(2,"0");
    },1000);
  }
};

/* ================= å°æ¸¬é©— ================= */
const Quiz = {
  q:[
    ["ä»Šå¤©å¿ƒæƒ…ï¼Ÿ",["å°ˆæ³¨","ç´¯","ç²¾ç¥"]],
    ["ä½ åƒå“ªéš»å°é›ï¼Ÿ",["å‹‡æ•¢","å‘†èŒ","å†·éœ"]]
  ],
  i:0,
  show(){
    const q=Quiz.q[Quiz.i];
    document.getElementById("quizQ").textContent=q[0];
    const o=document.getElementById("quizOpt");
    o.innerHTML="";
    q[1].forEach(a=>{
      const b=document.createElement("button");
      b.textContent=a;
      b.onclick=()=>{State.chickPersonality=a; UI.update()};
      o.appendChild(b);
    });
  }
};
Quiz.show();

/* ================= åœ–è¡¨ ================= */
new Chart(document.getElementById("studyChart"),{
  type:"line",
  data:{
    labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
    datasets:[{data:State.study}]
  }
});
</script>

</body>
</html>
