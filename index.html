<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Study Program</title>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* ================= å…¨åŸŸ ================= */
body{
  margin:0; padding:0;
  font-family:"Microsoft JhengHei",sans-serif;
  background: linear-gradient(#ffe6f7,#d6e8ff);
  text-align:center;
  transition:.4s;
}
.dark-mode{
  background:linear-gradient(#1c1c1c,#333);
  color:#fff;
}
.btn{
  padding:10px 15px;
  margin:5px;
  border:none;
  border-radius:12px;
  background:#ffb8d1;
  cursor:pointer;
}
.dark-mode .btn{background:#555;color:#fff;}
.card{
  background:#fff;
  padding:20px;
  margin:15px auto;
  border-radius:20px;
  width:300px;
  box-shadow:0 4px 12px rgba(0,0,0,.2);
}
.dark-mode .card{background:#222;color:#fff;}
.section{display:none}

/* ================= å°é› ================= */
.chick-container{width:200px;margin:20px auto;}
@keyframes float{
  0%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
  100%{transform:translateY(0)}
}
#home .chick-container{animation:float 3s ease-in-out infinite}

/* ================= é€²åº¦æ¢ ================= */
.level-bar{
  width:80%;height:18px;background:#ddd;
  border-radius:10px;margin:auto;overflow:hidden;
}
.level-progress{
  height:100%;width:0%;
  background:linear-gradient(90deg,#ff95be,#ffb8d1);
}
</style>
</head>

<body>

<h1>ğŸŒŸ Study Program</h1>
<p>å°é›åŠ©æ•™é™ªä½ å­¸ç¿’å†’éšª</p>

<!-- å°è¦½ -->
<div>
  <button class="btn" onclick="showSection('home')">ğŸ  é¦–é </button>
  <button class="btn" onclick="showSection('pomodoro')">ğŸ… ç•ªèŒ„é˜</button>
  <button class="btn" onclick="showSection('quiz')">ğŸ® æ¸¬é©—</button>
  <button class="btn" onclick="showSection('chart')">ğŸ“Š ç´€éŒ„</button>
  <button class="btn" onclick="showSection('leaderboard')">ğŸ† æ’è¡Œ</button>
  <button class="btn" onclick="toggleMode()">ğŸŒ™ æ·±è‰²</button>
</div>

<hr width="80%">

<!-- ================= é¦–é  ================= -->
<section id="home" class="section" style="display:block">
  <div class="card">
    <h3>ğŸ¥ å°é›</h3>
    <div class="chick-container">
      <svg viewBox="0 0 200 200">
        <circle cx="100" cy="120" r="50" fill="#FFEB3B"/>
        <circle cx="80" cy="100" r="8"/>
        <circle cx="120" cy="100" r="8"/>
        <polygon points="100,115 90,130 110,130" fill="#FF9800"/>
      </svg>
    </div>
    <p id="chickPersonalityText">å°šæœªæ¸¬é©—</p>
  </div>

  <div class="card">
    <h3>â¬†ï¸ ç­‰ç´š</h3>
    <div class="level-bar">
      <div id="levelProgress" class="level-progress"></div>
    </div>
    <p id="levelText">Lv.1 å†’éšªæ–°æ‰‹</p>
    <p>ä»Šæ—¥è®€æ›¸ï¼š<span id="todayTime">0</span> å°æ™‚</p>
  </div>
</section>

<!-- ================= ç•ªèŒ„é˜ ================= -->
<section id="pomodoro" class="section">
  <div class="card">
    <h2>ğŸ… ç•ªèŒ„é˜</h2>
    <div id="timerDisplay" style="font-size:48px">25:00</div>
    <button class="btn" onclick="startTimer()">é–‹å§‹</button>
    <button class="btn" onclick="resetTimer()">é‡è¨­</button>
  </div>
</section>

<!-- ================= å°æ¸¬é©— ================= -->
<section id="quiz" class="section">
  <div class="card">
    <h2>ğŸ® å°é›æ¸¬é©—</h2>
    <p id="quizQuestion"></p>
    <div id="quizOptions"></div>
    <h3 id="quizResult"></h3>
    <button class="btn" onclick="resetQuiz()">é‡æ–°æ¸¬é©—</button>
  </div>
</section>

<!-- ================= åœ–è¡¨ ================= -->
<section id="chart" class="section">
  <div class="card">
    <h2>ğŸ“Š è®€æ›¸ç´€éŒ„</h2>
    <canvas id="studyChart" width="280"></canvas>
  </div>
</section>

<!-- ================= æ’è¡Œæ¦œ ================= -->
<section id="leaderboard" class="section">
  <div class="card">
    <h2>ğŸ† æ’è¡Œæ¦œ</h2>
    <input id="playerName" placeholder="è¼¸å…¥åç¨±">
    <button class="btn" onclick="login()">ç™»å…¥</button>
    <p>åˆ†äº«ç¢¼ï¼š<span id="shareCode">-</span></p>
    <ul id="leaderboardList"></ul>
  </div>
</section>

<script>
/* ========== åŸºæœ¬åˆ‡æ› ========== */
function showSection(id){
  document.querySelectorAll(".section").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
}

/* ========== æ·±è‰²æ¨¡å¼ ========== */
let dark=false;
function toggleMode(){
  dark=!dark;
  document.body.classList.toggle("dark-mode",dark);
  chart.update();
}

/* ========== ç©å®¶ / å­˜æª” ========== */
let players=JSON.parse(localStorage.getItem("players")||"{}");
let current=null;

/* ========== ç­‰ç´š ========== */
let level=1,exp=0;
function addEXP(n){
  exp+=n;
  if(exp>=level*50){exp=0;level++;}
  updateLevel();
}
function updateLevel(){
  document.getElementById("levelText").textContent=`Lv.${level}`;
  document.getElementById("levelProgress").style.width=(exp/(level*50)*100)+"%";
}

/* ========== ç•ªèŒ„é˜ ========== */
let time=1500,interval;
function updateTimer(){
  let m=Math.floor(time/60),s=time%60;
  timerDisplay.textContent=`${m}:${s<10?"0":""}${s}`;
}
function startTimer(){
  clearInterval(interval);
  interval=setInterval(()=>{
    time--;
    if(time<=0){
      clearInterval(interval);
      addEXP(10);
      addStudy(0.5);
      save();
    }
    updateTimer();
  },1000);
}
function resetTimer(){clearInterval(interval);time=1500;updateTimer();}
updateTimer();

/* ========== åœ–è¡¨ ========== */
let study=[0,0,0,0,0,0,0];
const chart=new Chart(studyChart,{
  type:"line",
  data:{labels:["ä¸€","äºŒ","ä¸‰","å››","äº”","å…­","æ—¥"],
  datasets:[{data:study,label:"å°æ™‚"}]}
});
function addStudy(h){
  let d=(new Date().getDay()+6)%7;
  study[d]+=h;
  todayTime.textContent=study[d];
  chart.update();
}

/* ========== æ¸¬é©— ========== */
const quiz=[
 {q:"ä»Šå¤©å¿ƒæƒ…ï¼Ÿ",a:["å°ˆæ³¨","ç´¯","ç²¾ç¥"]},
 {q:"é‡åˆ°å›°é›£ï¼Ÿ",a:["åŠªåŠ›","ä¼‘æ¯","æ‰¾äºº"]}
];
let qi=0,qa=[];
function showQuiz(){
  quizQuestion.textContent=quiz[qi].q;
  quizOptions.innerHTML="";
  quiz[qi].a.forEach(o=>{
    let b=document.createElement("button");
    b.className="btn";b.textContent=o;
    b.onclick=()=>{qa.push(o);qi++;qi<quiz.length?showQuiz():finishQuiz();}
    quizOptions.appendChild(b);
  });
}
function finishQuiz(){
  chickPersonalityText.textContent="å‹‡æ•¢å°é›";
}
function resetQuiz(){qi=0;qa=[];showQuiz();}
showQuiz();

/* ========== ç™»å…¥ / æ’è¡Œ ========== */
function login(){
  const name=playerName.value.trim();
  if(!name) return;
  current=name;
  if(!players[name]) players[name]={level:1,exp:0,study:[0,0,0,0,0,0,0],code:Math.random().toString(36).slice(2,6)};
  load();
}
function save(){
  if(!current) return;
  players[current]={level,exp,study,code:players[current].code};
  localStorage.setItem("players",JSON.stringify(players));
  updateBoard();
}
function load(){
  let p=players[current];
  level=p.level;exp=p.exp;study=p.study;
  shareCode.textContent=p.code;
  updateLevel();chart.update();
  updateBoard();
}
function updateBoard(){
  leaderboardList.innerHTML="";
  Object.entries(players).sort((a,b)=>b[1].level-a[1].level)
  .forEach(([n,p],i)=>{
    let li=document.createElement("li");
    li.textContent=`${i+1}. ${n} Lv.${p.level}`;
    leaderboardList.appendChild(li);
  });
}
</script>
</body>
</html>
