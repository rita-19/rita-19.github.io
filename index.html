<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Study Program</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:"Microsoft JhengHei",sans-serif;
  background: linear-gradient(#ffe6f7,#d6e8ff);
  text-align:center;
}
.btn{
  padding:10px 15px;
  margin:5px;
  border:none;
  border-radius:12px;
  background:#ffb8d1;
  cursor:pointer;
}
.btn:hover{background:#ff95be;}
.card{
  background:white;
  padding:20px;
  margin:15px;
  border-radius:20px;
  display:inline-block;
  width:260px;
}
.section{display:none;}
.level-bar{
  width:80%; height:20px;
  background:#eee;
  border-radius:10px;
  margin:auto;
}
.level-progress{
  height:100%;
  background:#ff95be;
  width:0%;
}
.chick-container{
  width:120px;
  margin:auto;
  animation: float 3s ease-in-out infinite;
}
@keyframes float{
  0%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
  100%{transform:translateY(0)}
}
.popup{
  position:fixed;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  background:#ffeb3b;
  padding:10px 20px;
  border-radius:20px;
  font-weight:bold;
}
</style>
</head>

<body>

<h1>ğŸŒŸ Study Program</h1>

<div>
  <button class="btn" onclick="showSection('home')">é¦–é </button>
  <button class="btn" onclick="showSection('pomodoro')">ç•ªèŒ„é˜</button>
  <button class="btn" onclick="showSection('quiz')">å°æ¸¬é©—</button>
  <button class="btn" onclick="showSection('chart')">è®€æ›¸æ•¸æ“š</button>
  <button class="btn" onclick="showSection('leaderboard')">æ’è¡Œæ¦œ</button>
</div>

<!-- ===== é¦–é  ===== -->
<section id="home" class="section" style="display:block">
  <div class="chick-container">ğŸ¥</div>

  <div class="card">
    <h3>ä»Šæ—¥è®€æ›¸</h3>
    <p id="todayTime">0 å°æ™‚</p>
  </div>

  <div class="card">
    <h3>ç­‰ç´š</h3>
    <div class="level-bar">
      <div id="levelProgress" class="level-progress"></div>
    </div>
    <p id="levelText">Lv.1 å†’éšªæ–°æ‰‹</p>
  </div>

  <div class="card">
    <h3>å°é›æ€§æ ¼</h3>
    <p id="chickPersonalityText">å°šæœªæ¸¬é©—</p>
  </div>
</section>

<!-- ===== ç•ªèŒ„é˜ ===== -->
<section id="pomodoro" class="section">
  <h2>ğŸ… ç•ªèŒ„é˜</h2>
  <div id="timerDisplay" style="font-size:40px">25:00</div>
  <button class="btn" onclick="startTimer()">é–‹å§‹</button>
  <button class="btn" onclick="resetTimer()">é‡è¨­</button>
</section>

<!-- ===== å°æ¸¬é©— ===== -->
<section id="quiz" class="section">
  <div class="card">
    <p id="quizQuestion"></p>
    <div id="quizOptions"></div>
    <h3 id="quizResult"></h3>
    <button class="btn" onclick="resetQuiz()">é‡æ–°æ¸¬é©—</button>
  </div>
</section>

<!-- ===== åœ–è¡¨ ===== -->
<section id="chart" class="section">
  <canvas id="studyChart" width="350"></canvas>
</section>

<!-- ===== æ’è¡Œæ¦œ ===== -->
<section id="leaderboard" class="section">
  <div class="card">
    <input id="playerName" placeholder="è¼¸å…¥åå­—">
    <button class="btn" onclick="login()">ç™»å…¥</button>
    <ul id="leaderboardList"></ul>
  </div>
</section>

<script>
/* ===== ç‹€æ…‹ ===== */
let level=1, exp=0;
let timer=25*60, timerInt;
let studyData=[0,0,0,0,0,0,0];
let quizIndex=0, quizAnswers=[], chickPersonality="";
let players={}, currentPlayer=null;

/* ===== å·¥å…· ===== */
function showSection(id){
  document.querySelectorAll(".section").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
}

/* ===== ç­‰ç´š ===== */
function addEXP(v){
  exp+=v;
  if(exp>=level*50){exp=0;level++;popup("â¬†ï¸ å‡ç´šï¼")}
  updateLevelUI();
}
function updateLevelUI(){
  levelProgress.style.width=(exp/(level*50))*100+"%";
  levelText.textContent=`Lv.${level}`;
}

/* ===== ç•ªèŒ„é˜ ===== */
function updateTimer(){
  let m=Math.floor(timer/60), s=timer%60;
  timerDisplay.textContent=`${m}:${s.toString().padStart(2,"0")}`;
}
function startTimer(){
  clearInterval(timerInt);
  timerInt=setInterval(()=>{
    if(timer<=0){
      clearInterval(timerInt);
      addEXP(10);
      addStudy(0.5);
      return;
    }
    timer--; updateTimer();
  },1000);
}
function resetTimer(){timer=25*60;updateTimer();}

/* ===== è®€æ›¸ ===== */
function addStudy(h){
  let d=(new Date().getDay()+6)%7;
  studyData[d]+=h;
  todayTime.textContent=studyData[d]+" å°æ™‚";
  chart.update();
}

/* ===== æ¸¬é©— ===== */
const quizQ=[
 {q:"å­¸ç¿’æ™‚ä½ é€šå¸¸ï¼Ÿ",a:["å°ˆæ³¨","æ”¾ç©º","åŠªåŠ›"]},
 {q:"é‡åˆ°å›°é›£ä½ æœƒï¼Ÿ",a:["è§£æ±º","ä¼‘æ¯","æ±‚åŠ©"]}
];
function showQuiz(){
  quizQuestion.textContent=quizQ[quizIndex].q;
  quizOptions.innerHTML="";
  quizQ[quizIndex].a.forEach(o=>{
    let b=document.createElement("button");
    b.className="btn"; b.textContent=o;
    b.onclick=()=>select(o);
    quizOptions.appendChild(b);
  });
}
function select(a){
  quizAnswers.push(a); quizIndex++;
  if(quizIndex<quizQ.length) showQuiz();
  else{
    chickPersonality="å‹‡æ•¢å°é›";
    quizResult.textContent="ğŸ¥ "+chickPersonality;
    chickPersonalityText.textContent=chickPersonality;
  }
}
function resetQuiz(){
  quizIndex=0;quizAnswers=[];quizResult.textContent="";
  showQuiz();
}

/* ===== æ’è¡Œæ¦œ ===== */
function login(){
  const n=playerName.value.trim();
  if(!n) return;
  currentPlayer=n;
  players[n]={level,exp};
  renderLeaderboard();
}
function renderLeaderboard(){
  leaderboardList.innerHTML="";
  Object.entries(players).sort((a,b)=>b[1].level-a[1].level)
    .forEach(([n,p],i)=>{
      let li=document.createElement("li");
      li.textContent=`${i+1}. ${n} Lv.${p.level}`;
      leaderboardList.appendChild(li);
    });
}

/* ===== åœ–è¡¨ ===== */
const chart=new Chart(studyChart,{
  type:"line",
  data:{labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
  datasets:[{data:studyData,label:"è®€æ›¸æ™‚æ•¸"}]}
});

/* ===== æç¤º ===== */
function popup(t){
  const d=document.createElement("div");
  d.className="popup"; d.textContent=t;
  document.body.appendChild(d);
  setTimeout(()=>d.remove(),1500);
}

/* ===== åˆå§‹åŒ– ===== */
updateTimer(); updateLevelUI(); showQuiz();
</script>

</body>
</html>
