<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Study Programï½œç‹è€…å®Œæ•´ç‰ˆ</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:"Microsoft JhengHei","å¾®è»Ÿæ­£é»‘é«”",sans-serif;
  font-size:18px;
  background:linear-gradient(#ffe6f7,#d6e8ff);
  text-align:center;
  transition:.3s;
}
body.dark{
  background:linear-gradient(160deg,#0f2027,#203a43,#2c5364);
  color:#eee;
}
.btn{
  padding:10px 16px;
  border:none;
  border-radius:14px;
  background:#ffb8d1;
  cursor:pointer;
  margin:5px;
}
body.dark .btn{
  background:#444;
  color:#fff;
}
.card{
  background:#fff;
  border-radius:20px;
  padding:20px;
  margin:15px;
  width:280px;
  display:inline-block;
}
body.dark .card{
  background:rgba(255,255,255,.08);
  color:#fff;
}
.section{display:none}

/* å°é› */
@keyframes float{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
}
.chick-container{
  font-size:80px;
  animation:float 3s infinite;
}
body.dark .chick-container{
  animation:float 3s infinite, pulse 3s infinite;
}
@keyframes pulse{
  50%{filter:drop-shadow(0 0 20px gold)}
}
.chick-container.brave{filter:drop-shadow(0 0 18px gold)}
.chick-container.calm{filter:drop-shadow(0 0 18px #6cf)}
.chick-container.cute{filter:drop-shadow(0 0 18px pink)}
</style>
</head>

<body>

<h1>ğŸ¥ Study Program</h1>

<div>
  <button class="btn" onclick="UI.show('home')">é¦–é </button>
  <button class="btn" onclick="UI.show('pomodoro')">ç•ªèŒ„é˜</button>
  <button class="btn" onclick="UI.show('quiz')">å°æ¸¬é©—</button>
  <button class="btn" onclick="UI.show('chart')">æ•¸æ“š</button>
  <button class="btn" onclick="UI.show('leader')">æ’è¡Œæ¦œ</button>
  <button class="btn" onclick="UI.toggleDark()">ğŸŒ™</button>
</div>

<section id="home" class="section" style="display:block">
  <div class="chick-container">ğŸ¥</div>
  <div class="card"><h3>ç­‰ç´š</h3><p id="levelText">Lv.1</p></div>
  <div class="card"><h3>ä»Šæ—¥è®€æ›¸</h3><p id="todayTime">0 å°æ™‚</p></div>
  <div class="card"><h3>å°é›æ€§æ ¼</h3><p id="chickText">å°šæœªæ¸¬é©—</p></div>
</section>

<section id="pomodoro" class="section">
  <h2>ğŸ… ç•ªèŒ„é˜</h2>
  <h3 id="pomoMode">å°ˆæ³¨</h3>
  <div id="timer" style="font-size:40px">25:00</div>
  <button class="btn" onclick="Pomodoro.start()">é–‹å§‹</button>
  <button class="btn" onclick="Pomodoro.pause()">æš«åœ</button>
  <button class="btn" onclick="Pomodoro.reset()">é‡è¨­</button>
</section>

<section id="quiz" class="section">
  <div class="card">
    <p id="quizQ"></p>
    <div id="quizOpt"></div>
  </div>
</section>

<section id="chart" class="section">
  <canvas id="studyChart" width="300"></canvas>
</section>

<section id="leader" class="section">
  <div class="card">
    <input id="name" placeholder="ç©å®¶åç¨±">
    <button class="btn" onclick="Player.login()">ç™»å…¥</button>
    <p>åˆ†äº«ç¢¼ï¼š<b id="code">---</b></p>
    <ul id="rank"></ul>
  </div>
</section>

<script>
/* ===== State ===== */
const State={
  level:1,exp:0,study:[0,0,0,0,0,0,0],
  chick:"",dark:false,players:{},me:null
};

/* ===== UI ===== */
const UI={
  show(id){
    document.querySelectorAll('.section').forEach(s=>s.style.display='none');
    document.getElementById(id).style.display='block';
  },
  toggleDark(){
    State.dark=!State.dark;
    document.body.classList.toggle('dark',State.dark);
    save();
  },
  update(){
    levelText.textContent="Lv."+State.level;
    todayTime.textContent=State.study[new Date().getDay()||6]+" å°æ™‚";
    chickText.textContent=State.chick||"å°šæœªæ¸¬é©—";
    const chick=document.querySelector('.chick-container');
    chick.className='chick-container';
    if(State.chick) chick.classList.add(State.chick);
  }
};

/* ===== å‡ç´š ===== */
function addExp(n){
  State.exp+=n;
  if(State.exp>=State.level*50){
    State.exp-=State.level*50;
    State.level++;
    alert("â¬†ï¸ å‡ç´š Lv."+State.level);
  }
  UI.update(); save();
}

/* ===== ç•ªèŒ„é˜ ===== */
const Pomodoro={
  t:1500,id:null,mode:"focus",
  start(){
    if(this.id) return;
    this.id=setInterval(()=>{
      this.t--; this.render();
      if(this.t<=0) this.finish();
    },1000);
  },
  pause(){clearInterval(this.id);this.id=null},
  reset(){this.pause();this.set("focus")},
  finish(){
    this.pause();
    if(this.mode==="focus"){
      State.study[new Date().getDay()||6]+=0.5;
      addExp(25); this.set("break");
      alert("ğŸ… å®Œæˆï¼");
    }else this.set("focus");
  },
  set(m){
    this.mode=m;
    this.t=m==="focus"?1500:300;
    pomoMode.textContent=m==="focus"?"å°ˆæ³¨":"ä¼‘æ¯";
    this.render();
  },
  render(){
    timer.textContent=
      Math.floor(this.t/60)+":"+String(this.t%60).padStart(2,"0");
  }
};

/* ===== å°æ¸¬é©— ===== */
const Quiz={
  i:0,
  q:[
    ["ä½ é‡åˆ°å›°é›£æœƒï¼Ÿ",["brave","calm","cute"]],
    ["ä½ è¦ºå¾—è‡ªå·±ï¼Ÿ",["brave","calm","cute"]]
  ],
  show(){
    quizQ.textContent=this.q[this.i][0];
    quizOpt.innerHTML="";
    this.q[this.i][1].forEach(a=>{
      const b=document.createElement("button");
      b.className="btn";
      b.textContent=a;
      b.onclick=()=>{
        State.chick=a;
        this.i++;
        this.i<this.q.length?this.show():(addExp(30),UI.update(),save());
      };
      quizOpt.appendChild(b);
    });
  }
};

/* ===== ç©å®¶ ===== */
const Player={
  login(){
    const n=name.value.trim();
    if(!n) return;
    if(!State.players[n])
      State.players[n]={level:1,code:Math.random().toString(36).slice(2,8)};
    State.me=n;
    code.textContent=State.players[n].code;
    this.rank();
  },
  rank(){
    rank.innerHTML="";
    Object.entries(State.players).forEach(([n,d])=>{
      const li=document.createElement("li");
      li.textContent=n+" Lv."+d.level;
      rank.appendChild(li);
    });
  }
};

/* ===== å­˜æª” ===== */
function save(){localStorage.setItem("study",JSON.stringify(State))}
function load(){
  const d=localStorage.getItem("study");
  if(d) Object.assign(State,JSON.parse(d));
}

load(); UI.update(); Quiz.show(); Pomodoro.render();
new Chart(studyChart,{type:"line",
  data:{labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
  datasets:[{data:State.study}]}
});
</script>

</body>
</html>
