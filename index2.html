<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Study Programï½œç‹è€…å®Œæ•´ç‰ˆ</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:"Microsoft JhengHei","å¾®è»Ÿæ­£é»‘é«”",sans-serif;
  font-size:18px;
  background:linear-gradient(#ffe6f7,#d6e8ff);
  text-align:center;
}
body.dark{
  background:linear-gradient(160deg,#0f2027,#203a43,#2c5364);
  color:#eee;
}
.btn{
  padding:10px 16px;
  border:none;
  border-radius:14px;
  background:#ffb8d1;
  cursor:pointer;
  margin:5px;
}
body.dark .btn{background:#444;color:#fff}
.card{
  background:#fff;
  border-radius:20px;
  padding:20px;
  margin:10px;
  display:inline-block;
  width:280px;
}
body.dark .card{
  background:rgba(255,255,255,0.08);
}
.section{display:none}
@keyframes float{
  0%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
  100%{transform:translateY(0)}
}
.chick{
  font-size:80px;
  animation:float 3s infinite;
}
body.dark .chick.brave{filter:drop-shadow(0 0 15px gold)}
body.dark .chick.calm{filter:drop-shadow(0 0 15px #6cf)}
body.dark .chick.cute{filter:drop-shadow(0 0 15px pink)}
</style>
</head>

<body>

<h1>ğŸ¥ Study Program</h1>

<div>
  <button class="btn" onclick="show('home')">é¦–é </button>
  <button class="btn" onclick="show('pomodoro')">ç•ªèŒ„é˜</button>
  <button class="btn" onclick="show('quiz')">å°æ¸¬é©—</button>
  <button class="btn" onclick="show('chart')">æ•¸æ“š</button>
  <button class="btn" onclick="show('leader')">æ’è¡Œæ¦œ</button>
  <button class="btn" onclick="toggleDark()">ğŸŒ™</button>
</div>

<section id="home" class="section" style="display:block">
  <div id="chick" class="chick">ğŸ¥</div>
  <div class="card">ç­‰ç´š<br><b id="lv">1</b></div>
  <div class="card">ä»Šæ—¥å­¸ç¿’<br><b id="today">0</b> å°æ™‚</div>
  <div class="card">æ€§æ ¼<br><b id="person">æœªæ¸¬é©—</b></div>
</section>

<section id="pomodoro" class="section">
  <h2 id="mode">ğŸ¯ å°ˆæ³¨</h2>
  <div id="time" style="font-size:40px">25:00</div>
  <button class="btn" onclick="pStart()">é–‹å§‹</button>
  <button class="btn" onclick="pPause()">æš«åœ</button>
  <button class="btn" onclick="pReset()">é‡è¨­</button>
</section>

<section id="quiz" class="section">
  <div class="card">
    <p id="q"></p>
    <div id="opt"></div>
  </div>
</section>

<section id="chart" class="section">
  <canvas id="c"></canvas>
</section>

<section id="leader" class="section">
  <div class="card">
    <input id="name" placeholder="åå­—">
    <button class="btn" onclick="login()">ç™»å…¥</button>
    <p>åˆ†äº«ç¢¼ï¼š<b id="code">â€”</b></p>
    <hr>
    <input id="find" placeholder="æŸ¥è©¢åˆ†äº«ç¢¼">
    <button class="btn" onclick="search()">æŸ¥è©¢</button>
    <p id="result"></p>
    <hr>
    <ul id="rank"></ul>
  </div>
</section>

<script>
let S={
  lv:1,exp:0,study:[0,0,0,0,0,0,0],
  person:"",dark:false,
  me:null,players:{}
};

function save(){localStorage.study=JSON.stringify(S)}
function load(){if(localStorage.study)S=JSON.parse(localStorage.study)}

function show(id){
  document.querySelectorAll(".section").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
}

function toggleDark(){
  S.dark=!S.dark;
  document.body.classList.toggle("dark",S.dark);
  save();
}

function update(){
  lv.textContent=S.lv;
  today.textContent=S.study[new Date().getDay()||6];
  person.textContent=S.person||"æœªæ¸¬é©—";
  chick.className="chick "+(S.person==="å‹‡æ•¢"?"brave":S.person==="å†·éœ"?"calm":S.person==="å‘†èŒ"?"cute":"");
}

let pTime=1500,pInt=null,mode="focus";
function pRender(){
  time.textContent=Math.floor(pTime/60)+":"+String(pTime%60).padStart(2,"0");
}
function pStart(){
  if(pInt)return;
  pInt=setInterval(()=>{
    pTime--;
    pRender();
    if(pTime<=0)pFinish();
  },1000);
}
function pPause(){clearInterval(pInt);pInt=null}
function pReset(){pPause();mode="focus";pTime=1500;pRender()}
function pFinish(){
  pPause();
  if(mode==="focus"){
    S.exp+=25;
    if(S.exp>=S.lv*50){S.exp=0;S.lv++}
    S.study[new Date().getDay()||6]+=0.5;
    mode="rest";pTime=300;
  }else{mode="focus";pTime=1500}
  update();save();pRender();
}

const Q=[
 ["ä½ åƒå“ªç¨®å°é›ï¼Ÿ",["å‹‡æ•¢","å†·éœ","å‘†èŒ"]],
 ["é‡åˆ°å›°é›£ï¼Ÿ",["å‹‡æ•¢","å†·éœ","å‘†èŒ"]]
];
let qi=0;
function showQ(){
  q.textContent=Q[qi][0];
  opt.innerHTML="";
  Q[qi][1].forEach(a=>{
    let b=document.createElement("button");
    b.className="btn";b.textContent=a;
    b.onclick=()=>{S.person=a;qi++;qi<Q.length?showQ():finishQ()};
    opt.appendChild(b);
  });
}
function finishQ(){update();save();alert("å®Œæˆï¼")}

function login(){
  let n=name.value.trim();if(!n)return;
  if(!S.players[n])S.players[n]={lv:1,code:Math.random().toString(36).slice(2,8)};
  S.me=n;code.textContent=S.players[n].code;
  drawRank();save();
}
function search(){
  let c=find.value;result.textContent="æ‰¾ä¸åˆ°";
  for(let n in S.players)
    if(S.players[n].code===c)result.textContent=n+" Lv."+S.players[n].lv;
}
function drawRank(){
  rank.innerHTML="";
  Object.entries(S.players)
    .sort((a,b)=>b[1].lv-a[1].lv)
    .forEach(([n,d])=>{
      let li=document.createElement("li");
      li.textContent=n+" Lv."+d.lv;
      rank.appendChild(li);
    });
}

load();update();showQ();pRender();drawRank();
new Chart(c,{type:"line",data:{labels:["ä¸€","äºŒ","ä¸‰","å››","äº”","å…­","æ—¥"],datasets:[{data:S.study}]}})
</script>

</body>
</html>
