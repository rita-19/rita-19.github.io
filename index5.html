<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ¯æ—¥ä¸€å¥ãƒ»æš–å¿ƒå°èª</title>

<style>
body {
  margin: 0;
  min-height: 100vh;
  background: #000;
  color: #fff;
  font-family: "Microsoft JhengHei", sans-serif;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  padding: 20px;
}

h1 { margin-bottom: 20px; }

select, button, input {
  margin: 6px;
  padding: 8px 14px;
  font-size: 16px;
  border-radius: 6px;
  border: none;
}

select {
  background: #111;
  color: #fff;
  border: 1px solid #1E90FF;
}

button {
  background: #4CAF50;
  color: #fff;
  cursor: pointer;
}

button:hover { background: #45a049; }

#quote {
  max-width: 800px;
  margin-top: 20px;
  line-height: 1.6;
}

.english {
  color: #FFD700;
  font-family: "Comic Sans MS", cursive;
  font-size: 22px;
  margin-bottom: 8px;
}

.chinese {
  color: #fff;
  font-size: 26px;
}
</style>
</head>

<body>

<h1>ğŸª æ¯æ—¥ä¸€å¥ãƒ»æš–å¿ƒå°èª</h1>

<select id="category">
  <option value="success">æˆåŠŸ / åŠªåŠ›</option>
  <option value="mindset">å¿ƒæ…‹ / å‹‡æ°£</option>
  <option value="life">äººç”Ÿ / æ™ºæ…§</option>
  <option value="love">æ„›æƒ… / å‹æƒ…</option>
</select>

<div id="quote">è«‹æŒ‰ä¸‹ã€Œç”Ÿæˆåè¨€ã€</div>

<button onclick="generateQuote()">ç”Ÿæˆåè¨€</button>
<button onclick="copyLink()">ç”Ÿæˆåˆ†äº«é€£çµ</button>

<input id="shareLink" readonly style="width:80%">

<audio id="sound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>

<script>
// ================= åè¨€è³‡æ–™ =================
const quotes = {
  success: [
    "Failure is the mother of success. å¤±æ•—ä¹ƒæˆåŠŸä¹‹æ¯ã€‚",
    "If you really want something, go get it. å¦‚æœä½ çœŸçš„æƒ³è¦ï¼Œå°±å»çˆ­å–ã€‚"
  ],
  mindset: [
    "Stars canâ€™t shine without darkness. æ²’æœ‰é»‘æš—ï¼Œæ˜Ÿæ˜Ÿä¸æœƒé–ƒè€€ã€‚"
  ],
  life: [
    "Life is short and you deserve to be happy. äººç”ŸçŸ­æš«ï¼Œä½ å€¼å¾—å¿«æ¨‚ã€‚"
  ],
  love: [
    "You complete me. ä½ ä½¿æˆ‘äººç”Ÿå®Œæ•´ã€‚"
  ]
};

let currentCat = "";
let currentIndex = -1;

// ================= è‹±æ–‡æœ—è®€ =================
function speakEnglish(text) {
  if (!window.speechSynthesis) return;
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "en-US";
  u.rate = 0.9;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

// ================= ç”Ÿæˆåè¨€ =================
function generateQuote(catFromUrl = null, indexFromUrl = null) {
  const cat = catFromUrl || document.getElementById("category").value;
  const list = quotes[cat];

  const index = indexFromUrl !== null
    ? indexFromUrl
    : Math.floor(Math.random() * list.length);

  const text = list[index];

  currentCat = cat;
  currentIndex = index;

  const english = text.match(/[A-Za-z0-9.,!?'"()\-: ]+/g)?.join("").trim() || "";
  const chinese = text.replace(/[A-Za-z0-9.,!?'"()\-: ]+/g, "").trim();

  document.getElementById("quote").innerHTML = `
    <div class="english">${english}</div>
    <div class="chinese">${chinese}</div>
  `;

  if (english) speakEnglish(english);

  const sound = document.getElementById("sound");
  sound.currentTime = 0;
  sound.play();
}

// ================= åˆ†äº«é€£çµ =================
function copyLink() {
  if (currentIndex === -1) {
    alert("è«‹å…ˆç”Ÿæˆåè¨€");
    return;
  }

  const url =
    location.origin + location.pathname +
    `?cat=${currentCat}&id=${currentIndex}`;

  document.getElementById("shareLink").value = url;
  navigator.clipboard.writeText(url);
  alert("åˆ†äº«é€£çµå·²è¤‡è£½ï¼");
}

// ================= è¼‰å…¥é‚„åŸ =================
window.onload = () => {
  const p = new URLSearchParams(location.search);
  if (p.has("cat") && p.has("id")) {
    document.getElementById("category").value = p.get("cat");
    generateQuote(p.get("cat"), Number(p.get("id")));
  }
};
</script>

</body>
</html>
